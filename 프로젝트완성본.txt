//by 20162300 jungjaeyeob

#include <reg51.h>
sbit speaker = P3^0;
sbit swich = P1^7;
sbit led1= P3^1;



unsigned char time_data, tone_data;


unsigned char code tone_tc[] = {0x4d,0x2d, 0x33,0x39,0x4d, 0x4d,0x2d, 0x33,0x39, 0x44,
0x44,0x28,0x2d,0x33,0x3d,  0x25,0x25,0x28, 0x33,0x2d,0x33,
0x4d,0x2d, 0x33,0x39,0x4d, 0x4d,0x2d, 0x33,0x39, 0x44,
0x44,0x2d,0x28, 0x33,0x25,    0x25,0x25,0x25, 0x21,0x25,
0x28,0x33,0x39};
unsigned char code time_tc[] = {8,8,8, 8,24,8,8,8,8,24,
8,8,8,8,24,8,8,8,8,16,
8,8,8,8,8,24,8,8,8,8,
24,8,8,8,8,12,4,8,8,8,8,8,8,24};


unsigned char code tone_ta[] = {0x33,0x25,0x25,0x21,0x25,0x28,0x2d,0x2d,0x2d,
 0x21,0x21,0x1d,0x21,0x25,0x28,0x33,0x33,0x1d,0x1d,0x39,0x1d,0x21, 0x25,0x2d,0x33,0x33,0x2d,0x21,0x28,0x25};
unsigned char code time_ta[] = {16,16,8,8,8,8,16,16,16,16,
8,8,8,8,16,16,16,16,8,8,
8,8,16,16,8,8,16,16,16,32};


unsigned char code tone_tb[] = {0x33,0x2d,0x33,0x3d, 0x33,0x2d,0x33,0x3d,0x21,0x21,0x28,0x25,0x25,0x33,0x2d,0x2d,0x25,0x28,0x2d, 0x33,0x2d,0x33,0x3d,
0x2d,0x2d,0x25,0x28,0x2d, 0x33,0x2d,0x33,0x3d,0x21,0x21,0x1b,0x21,0x28,0x25,0x1d,0x25,0x33,0x3d,0x33,0x39};
unsigned char code time_tb[] = {12,4,8,24,12,4,8,24,  
16,8,24,16,8,24,16,8,12,4,8,12,4,8,24,
16,8,12,4,8,12,4,8,24,
16,8,12,4,8,24,24,    
8,8,8,12,4,0};

unsigned int segment[]={0xc0,0xf9,0xa4,0xb0};

unsigned char code led[]= {0xa6,0xe5,0x33,0xb3,0x46,0xa6,0x71,0xa6,0x73,0x36,0xa3,0x3a,0x75,0x3a,0xa3,0x47,0xa6,0x73,0x36,0xa3,0x3a,0xa6,0xaa,0x3b,0x3c,0x46};




void delay(unsigned char i)
{
while(i--);
}

void sound(void)
{
while(time_data){
speaker = 0; 
delay(tone_data);
speaker = 1; 
delay(tone_data);
}
}
void TMR0_int(void) interrupt 1
{
time_data--;
TH0 = 0x59; 
TL0 = 0x8b;
return;
}

void main(void)
 

{
 
unsigned char i;
TMOD = 0x01; 
TH0 = 0x59; 
TL0 = 0x8b; 
ET0 = 1; 
EA = 1;
PT0 = 1; 
TR0 = 1; 

	

	
 
 gogogo:
  do{
    
  if(swich==0){
      P1=segment[0];
	    P0=0xff;
		  led1=1;
	}
    else if(swich==0)
   goto start;
  
  }while(1);
  
  
 do{
  start: 
     for (i = 0; i<39; i++) {led1=0;
   P1=segment[1];
			 P0=led[i];
			 
     tone_data = tone_tb[i]; 
     time_data = time_tb[i]; 
		 	 
     sound();
   
    if(swich==0) goto label;
    
  };}while(1);
  {
 
     do{
    label:
     for (i = 0; i<39; i++) {led1=0;
   P1=segment[2];
			   P0=led[i];
     tone_data = tone_tc[i]; 
     time_data = time_tc[i]; 
     sound();
	
    
   if(swich==0) goto gogo;
   
   };}while(1);
  
  };
do{
    gogo:
     for (i = 0; i<30; i++) {led1=0;
   P1=segment[3];
			  P0=led[i];
     tone_data = tone_ta[i]; 
     time_data = time_ta[i]; 
     sound();

    
   if(swich==0) goto gogogo;
   
   };}while(1);
  }