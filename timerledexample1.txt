#include<reg51.h>


unsigned char led, count;

void TMR1_int(void) interrupt 1 //타이머 카운터 1인터럽트 벡터넘버 3
{
	EA=0;    //인터럽트 디스에이블 
	count--; // count값을 하나 감소
	if(count==0) { //1초가 경과하였는가? 20번째 들어왔는가? 라는 조건문 
		led=(led>>1) | 0x80; //LED상태변경
		if (led==0xff) led=0x7f; // 마지막인지 검사, 마지막 이면 재설정 
		P1=led; //포트 1로출력
		count=2; // 인터럽트 반복횟수 재설정
    }
  TH0=0xex; //시정수 설정(0.05초) 시정수값을 다시 정해줌
  TL0=0x78;//65536-50000=3CB0H 
  EA=1;//인터럽트 인에이블
  return;
}


void main (void)
{
	TMOD = 0x01; //타이머 1을 모드 1로설정
	TH0 = 0xex; //시정수 설정 0.05초
	TL0 = 0x78; // 65536 - 50000 = ex78H

	//여기서부터 인터럽트에 대한 설명
	ET0=1; //타이머 1 인터럽트 인에이블
	EA=1; //전체 인터럽트 인에이블
	PT0=1; //타이머 1 인터럽트 우선순위 중요X
	TR0=1; // 타이머 1 run

	led = 0x7f; // 초기 데이터 설정
	P1 =led; // 포트1 로 출력
	count =2; // 인터럽트 반복횟수 설정 1초를 만들기위해 20번을 반복
	while(1) // 인터럽트 대기
}
